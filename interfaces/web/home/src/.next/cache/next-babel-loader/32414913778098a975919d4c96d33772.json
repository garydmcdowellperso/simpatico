{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useEffect } from \"react\";\nimport Head from 'next/head';\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Container from \"@material-ui/core/Container\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Header from \"../components/Header\";\nimport Overview from \"../components/Overview\";\nimport Theme from \"../components/Theme\";\nimport Main from \"../components/Main\";\nimport Sidebar from \"../components/Sidebar\";\nimport Footer from \"../components/Footer\";\nimport nextI18NextInstance from '../../i18n';\nimport config from '../../config';\nimport { setDebateRequest } from '../actions/debate';\nimport { fetchPostsRequest } from '../actions/posts';\n\nvar getCurrentLang = function getCurrentLang() {\n  return nextI18NextInstance.i18n.language || 'en';\n};\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    mainGrid: {\n      marginTop: theme.spacing(3)\n    }\n  };\n});\n\nfunction Home(_ref) {\n  _s();\n\n  var debateServer = _ref.debateServer;\n  var dispatch = useDispatch();\n\n  if (debateServer) {\n    // Put the server side fetch into client side store\n    dispatch(setDebateRequest(debateServer));\n  }\n\n  var debate = useSelector(function (state) {\n    return state.debate.debate;\n  });\n\n  var _useSelector = useSelector(function (state) {\n    return state.posts;\n  }),\n      posts = _useSelector.posts;\n\n  var isValidToken = useSelector(function (state) {\n    return state.auth.isValidToken;\n  });\n  useEffect(function () {\n    // Fire once, get pages for the account\n    if (posts.length === 0) {\n      console.log('here', localStorage);\n      console.log('heere2', true);\n      dispatch(fetchPostsRequest(localStorage.getItem(\"accountId\")));\n    }\n  }, []);\n  useEffect(function () {\n    if (debate && debate.debateType === 'private') {\n      if (isValidToken === false) {\n        window.location.href = '/login/';\n      }\n    }\n  }, [isValidToken, debate]);\n  var classes = useStyles();\n\n  if (!debate) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(Head, null, /*#__PURE__*/React.createElement(\"title\", null, debate.slug), /*#__PURE__*/React.createElement(\"meta\", {\n    name: \"viewport\",\n    content: \"initial-scale=1.0, width=device-width\"\n  }), debate.metaTags.map(function (tag, idx) {\n    if (tag.type === 'property') {\n      return /*#__PURE__*/React.createElement(\"meta\", {\n        property: tag.typevalue,\n        content: tag.content,\n        key: idx\n      });\n    } else {\n      return /*#__PURE__*/React.createElement(\"meta\", {\n        name: tag.typevalue,\n        content: tag.content,\n        key: idx\n      });\n    }\n  })), debate ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CssBaseline, null), /*#__PURE__*/React.createElement(Container, {\n    maxWidth: \"lg\"\n  }, /*#__PURE__*/React.createElement(Header, {\n    selected: \"home\",\n    title: debate.slug,\n    header: debate.header\n  }), /*#__PURE__*/React.createElement(\"main\", null, /*#__PURE__*/React.createElement(Overview, {\n    data: debate.overview\n  }), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 4\n  }, debate.themes.map(function (theme) {\n    return /*#__PURE__*/React.createElement(Theme, {\n      key: theme.title[getCurrentLang()],\n      theme: theme\n    });\n  })), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 5,\n    className: classes.mainGrid\n  }, /*#__PURE__*/React.createElement(Main, {\n    title: \"Latest contributon\",\n    posts: posts\n  }), /*#__PURE__*/React.createElement(Sidebar, {\n    description: debate.sidebar.about[getCurrentLang()],\n    social: debate.sidebar.social\n  })))), /*#__PURE__*/React.createElement(Footer, {\n    footer: debate.footer\n  })) : null);\n}\n\n_s(Home, \"sSdM/r1DHGL75+yz/2RAiv29zBw=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useStyles];\n});\n\n_c = Home;\n\nHome.getInitialProps = async function (ctx) {\n  if (ctx.req) {\n    // Do a check if this debate exists before trying to render (no saga here, server side)\n    var res = await fetch(\"\".concat(config.api.host, \"/v1/fetchDebate?name=\").concat(ctx.req.headers.host));\n    var debateServer = await res.json();\n    return {\n      debateServer: debateServer\n    };\n  }\n\n  return {\n    debateServer: null\n  };\n};\n\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/gary/dev/simpatico/interfaces/web/home/src/pages/index.jsx"],"names":["React","useEffect","Head","makeStyles","CssBaseline","Grid","Container","useDispatch","useSelector","Header","Overview","Theme","Main","Sidebar","Footer","nextI18NextInstance","config","setDebateRequest","fetchPostsRequest","getCurrentLang","i18n","language","useStyles","theme","mainGrid","marginTop","spacing","Home","debateServer","dispatch","debate","state","posts","isValidToken","auth","length","console","log","localStorage","getItem","debateType","window","location","href","classes","slug","metaTags","map","tag","idx","type","typevalue","content","header","overview","themes","title","sidebar","about","social","footer","getInitialProps","ctx","req","res","fetch","api","host","headers","json"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport Head from 'next/head'\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Container from \"@material-ui/core/Container\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\n\nimport Header from \"../components/Header\";\nimport Overview from \"../components/Overview\";\nimport Theme from \"../components/Theme\";\nimport Main from \"../components/Main\";\nimport Sidebar from \"../components/Sidebar\";\nimport Footer from \"../components/Footer\";\nimport nextI18NextInstance from '../../i18n';\nimport config from '../../config';\n\nimport { setDebateRequest } from '../actions/debate';\nimport { fetchPostsRequest } from '../actions/posts';\n\nconst getCurrentLang = () => nextI18NextInstance.i18n.language || 'en';\n\nconst useStyles = makeStyles(theme => ({\n  mainGrid: {\n    marginTop: theme.spacing(3)\n  },\n}));\n\nfunction Home({ debateServer }) {\n  const dispatch = useDispatch();\n\n  if (debateServer) {\n    // Put the server side fetch into client side store\n    dispatch(setDebateRequest(debateServer))\n  }\n\n  const debate = useSelector(state => state.debate.debate);\n  const { posts } = useSelector(state => state.posts);\n  const isValidToken = useSelector(state => state.auth.isValidToken);\n\n  useEffect(() => { // Fire once, get pages for the account\n    if (posts.length === 0) {\n        console.log('here', localStorage)\n        console.log('heere2', typeof window !== 'undefined')\n        dispatch(fetchPostsRequest(localStorage.getItem(\"accountId\")));\n    }\n  }, []);\n\n  useEffect(() => {\n    if (debate && debate.debateType === 'private') {\n      if (isValidToken === false) {\n        window.location.href = '/login/';\n      }\n    }\n  }, [isValidToken, debate]);\n\n\n  const classes = useStyles();\n\n  if (!debate) {\n    return (<div/>)\n  }\n\n  return (\n    <div>\n      <Head>\n        <title>{debate.slug}</title>\n        <meta name=\"viewport\" content=\"initial-scale=1.0, width=device-width\" />\n        {debate.metaTags.map((tag, idx) => {\n\n            if (tag.type === 'property') {\n              return (<meta property={tag.typevalue} content={tag.content} key={idx} />)\n            } else  {\n              return (<meta name={tag.typevalue} content={tag.content} key={idx} />)\n            }\n        })}\n      </Head>\n      {debate ? (\n      <>\n        <CssBaseline />\n        <Container maxWidth=\"lg\">\n          <Header selected='home' title={debate.slug} header={debate.header} />\n          <main>\n            <Overview data={debate.overview} />\n            <Grid container spacing={4}>\n              {debate.themes.map(theme => (\n                <Theme key={theme.title[getCurrentLang()]} theme={theme} />\n              ))}\n            </Grid>\n            <Grid container spacing={5} className={classes.mainGrid}>\n              <Main title=\"Latest contributon\" posts={posts} />\n              <Sidebar\n                description={debate.sidebar.about[getCurrentLang()]}\n                social={debate.sidebar.social}\n              />\n            </Grid>\n          </main>\n        </Container>\n        <Footer footer={debate.footer} />\n      </>) : null }\n     </div>\n  );\n}\n\nHome.getInitialProps = async ctx => {\n  if (ctx.req) {\n    // Do a check if this debate exists before trying to render (no saga here, server side)\n    const res = await fetch(`${config.api.host}/v1/fetchDebate?name=${ctx.req.headers.host}`)\n    const debateServer = await res.json()\n\n    return {\n      debateServer\n    };\n  }\n\n  return {\n    debateServer: null\n  }\n}\n\nexport default Home;"]},"metadata":{},"sourceType":"module"}