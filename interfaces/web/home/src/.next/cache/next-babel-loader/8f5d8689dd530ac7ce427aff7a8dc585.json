{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useEffect } from \"react\";\nimport Head from 'next/head';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { HTMLRenderer } from \"@react-page/renderer\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Container from \"@material-ui/core/Container\";\nimport { useRouter } from 'next/router';\nimport Footer from \"../components/Footer\";\nimport \"@react-page/core/lib/index.css\"; // we also want to load the stylesheets\n\nimport \"@react-page/core/lib/index.css\"; // we also want to load the stylesheets\n// Require editor ui stylesheet\n\nimport \"@react-page/ui/lib/index.css\"; // Load some exemplary plugins:\n\nimport slate from \"@react-page/plugins-slate\"; // The rich text area plugin\n\nimport \"@react-page/plugins-slate/lib/index.css\"; // Stylesheets for the rich text area plugin\n\nimport background from \"@react-page/plugins-background\"; // A plugin for background images\n\nimport \"@react-page/plugins-background/lib/index.css\"; // Stylesheets for  background layout plugin\n\nimport image from \"@react-page/plugins-image\"; // A plugin for background images\n\nimport \"@react-page/plugins-image/lib/index.css\"; // Stylesheets for  background layout plugin\n\nimport video from \"@react-page/plugins-video\"; // A plugin for background images\n\nimport \"@react-page/plugins-video/lib/index.css\"; // Stylesheets for  background layout plugin\n\nimport spacer from \"@react-page/plugins-spacer\"; // A plugin for background images\n\nimport \"@react-page/plugins-spacer/lib/index.css\"; // Stylesheets for  background layout plugin\n\nimport Header from \"../components/Header\";\nimport { fetchPageRequest } from \"../actions/pages\";\nimport { fetchDebateRequest } from '../actions/debate';\nimport nextI18NextInstance from '../../i18n';\nimport { get } from \"../lib/api\";\n\nvar getCurrentLang = function getCurrentLang() {\n  return nextI18NextInstance.i18n.language || 'en';\n};\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    mainGrid: {\n      marginTop: theme.spacing(3)\n    }\n  };\n});\nvar plugins = {\n  content: [slate(), image, spacer, video],\n  // Define plugins for content cells. To import multiple plugins, use [slate(), image, spacer, divider]\n  layout: [background({\n    defaultPlugin: slate()\n  })] // Define plugins for layout cells\n\n};\n\nfunction CMSPage(props) {\n  _s();\n\n  var router = useRouter();\n  var pageId = router.query.page;\n  var title = router.query.title;\n  var dispatch = useDispatch();\n  var page = useSelector(function (state) {\n    return state.pages.page;\n  });\n  var debate = useSelector(function (state) {\n    return state.debate.debate;\n  });\n  useEffect(function () {\n    // Fire once, get page and debate\n    dispatch(fetchPageRequest(pageId));\n    dispatch(fetchDebateRequest(window.location.hostname));\n  }, []);\n  var classes = useStyles();\n\n  if (!page || !debate) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(Head, null, /*#__PURE__*/React.createElement(\"title\", null, debate.slug), /*#__PURE__*/React.createElement(\"meta\", {\n    name: \"viewport\",\n    content: \"initial-scale=1.0, width=device-width\"\n  })), /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CssBaseline, null), /*#__PURE__*/React.createElement(Container, {\n    maxWidth: \"lg\"\n  }, /*#__PURE__*/React.createElement(Header, {\n    selected: title,\n    title: debate.slug,\n    header: debate.header\n  }), /*#__PURE__*/React.createElement(\"main\", null, /*#__PURE__*/React.createElement(HTMLRenderer, {\n    plugins: plugins,\n    state: page.languages[getCurrentLang()]\n  }))), /*#__PURE__*/React.createElement(Footer, {\n    selected: title,\n    footer: debate.footer\n  })));\n}\n\n_s(CMSPage, \"gKfU2vgjXLLQ/lzL1rFRSLHXsoQ=\", false, function () {\n  return [useRouter, useDispatch, useSelector, useSelector, useStyles];\n});\n\n_c = CMSPage;\nexport var __N_SSP = true;\nexport default CMSPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"CMSPage\");","map":{"version":3,"sources":["/Users/gary/dev/simpatico/interfaces/web/home/src/pages/cmspage.jsx"],"names":["React","useEffect","Head","useDispatch","useSelector","makeStyles","HTMLRenderer","CssBaseline","Container","useRouter","Footer","slate","background","image","video","spacer","Header","fetchPageRequest","fetchDebateRequest","nextI18NextInstance","get","getCurrentLang","i18n","language","useStyles","theme","mainGrid","marginTop","spacing","plugins","content","layout","defaultPlugin","CMSPage","props","router","pageId","query","page","title","dispatch","state","pages","debate","window","location","hostname","classes","slug","header","languages","footer"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport Head from 'next/head'\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { HTMLRenderer } from \"@react-page/renderer\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Container from \"@material-ui/core/Container\";\nimport { useRouter } from 'next/router'\n\nimport Footer from \"../components/Footer\";\n\nimport \"@react-page/core/lib/index.css\"; // we also want to load the stylesheets\n\nimport \"@react-page/core/lib/index.css\"; // we also want to load the stylesheets\n// Require editor ui stylesheet\nimport \"@react-page/ui/lib/index.css\";\n\n// Load some exemplary plugins:\nimport slate from \"@react-page/plugins-slate\"; // The rich text area plugin\nimport \"@react-page/plugins-slate/lib/index.css\"; // Stylesheets for the rich text area plugin\nimport background from \"@react-page/plugins-background\"; // A plugin for background images\nimport \"@react-page/plugins-background/lib/index.css\"; // Stylesheets for  background layout plugin\nimport image from \"@react-page/plugins-image\"; // A plugin for background images\nimport \"@react-page/plugins-image/lib/index.css\"; // Stylesheets for  background layout plugin\nimport video from \"@react-page/plugins-video\"; // A plugin for background images\nimport \"@react-page/plugins-video/lib/index.css\"; // Stylesheets for  background layout plugin\nimport spacer from \"@react-page/plugins-spacer\"; // A plugin for background images\nimport \"@react-page/plugins-spacer/lib/index.css\"; // Stylesheets for  background layout plugin\n\nimport Header from \"../components/Header\";\nimport { fetchPageRequest } from \"../actions/pages\";\nimport { fetchDebateRequest } from '../actions/debate';\n\nimport nextI18NextInstance from '../../i18n';\n\nimport config from '../../config';\nimport { get } from \"../lib/api\";\n\nconst getCurrentLang = () => nextI18NextInstance.i18n.language || 'en';\n\nconst useStyles = makeStyles(theme => ({\n  mainGrid: {\n    marginTop: theme.spacing(3)\n  },\n}));\n\n\nconst plugins = {\n  content: [slate(), image, spacer, video], // Define plugins for content cells. To import multiple plugins, use [slate(), image, spacer, divider]\n  layout: [background({ defaultPlugin: slate() })] // Define plugins for layout cells\n};\n\nfunction CMSPage(props) {\n  const router = useRouter()\n  const pageId = router.query.page;\n  const title = router.query.title;\n\n  const dispatch = useDispatch();\n\n  const page = useSelector(state => state.pages.page);\n\n  const debate = useSelector(state => state.debate.debate);\n\n  useEffect(() => { // Fire once, get page and debate\n    dispatch(fetchPageRequest(pageId));\n    dispatch(fetchDebateRequest(window.location.hostname));\n  }, []);\n\n  const classes = useStyles();\n\n  if (!page || !debate) {\n    return (<div/>)\n  }\n\n  return (\n    <div>\n      <Head>\n        <title>{debate.slug}</title>\n        <meta name=\"viewport\" content=\"initial-scale=1.0, width=device-width\" />\n      </Head>\n      <>\n        <CssBaseline />\n        <Container maxWidth=\"lg\">\n          <Header selected={title} title={debate.slug} header={debate.header} />\n          <main>\n            <HTMLRenderer \n                plugins={plugins} \n                state={page.languages[getCurrentLang()]} \n            />\n          </main>\n        </Container>\n        <Footer selected={title} footer={debate.footer} />\n      </>\n    </div>\n  );\n}\n\nexport async function getServerSideProps(ctx) {\n  // Fetch the page contents\n  const res = await fetch(`${config.api.host}/v1/fetchPage?id=${ctx.query.page}`)\n  const page = await res.json()\n  \n  // Do a check if this debatee exists before trying to render (no saga here, server side)\n  const res2 = await fetch(`${config.api.host}/v1/fetchDebate?name=${ctx.req.headers.host}`)\n  const debate = await res2.json()\n\n  console.log('page', page)\n  console.log('debate', debate)\n\n  return {\n    props: {\n      page: page,\n      debate: debate\n    }\n  }\n}\n\nexport default CMSPage"]},"metadata":{},"sourceType":"module"}