{"version":3,"file":"static/chunks/1.js","sources":["webpack:///../node_modules/@react-page/create-plugin-materialui/lib-es/Controls/index.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { BottomToolbar } from '@react-page/ui';\nimport debounce from 'lodash.debounce';\nimport React, { Fragment, useCallback, useEffect, useMemo, useState } from 'react';\nimport { AutoFields as AutoFieldsOrg, AutoForm as AutoFormOrg } from 'uniforms-material';\nimport makeUniformsSchema from '../utils/makeUniformsSchema';\n// see https://github.com/vazco/uniforms/issues/617\n// tslint:disable-next-line:no-any\nvar AutoForm = AutoFormOrg;\n// tslint:disable-next-line:no-any\nvar AutoFields = AutoFieldsOrg;\nvar defaultControlsLayout = {\n    columnCount: 2,\n};\nvar getDefaultValue = function (bridge) {\n    return bridge.getSubfields(null).reduce(function (acc, fieldName) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[fieldName] = bridge.getInitialValue(fieldName), _a)));\n    }, {});\n};\nfunction Controls(props) {\n    var saveDebounced = useCallback(debounce(function (m) { return props.onChange(m); }, 1000), [props.onChange]);\n    var _a = __read(useState(), 2), preview = _a[0], setPreview = _a[1];\n    var onSubmit = useCallback(function (model) {\n        setPreview(model);\n        saveDebounced(model);\n    }, []);\n    var focused = props.focused, state = props.state, schema = props.schema, _b = props.controlsLayout, controlsLayout = _b === void 0 ? defaultControlsLayout : _b, Renderer = props.Renderer, remove = props.remove;\n    var bridge = useMemo(function () { return makeUniformsSchema(schema); }, [schema]);\n    useEffect(function () {\n        var _a;\n        onSubmit(__assign(__assign({}, getDefaultValue(bridge)), (_a = (preview !== null && preview !== void 0 ? preview : state), (_a !== null && _a !== void 0 ? _a : {}))));\n    }, [bridge]);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(Renderer, __assign({}, props, { state: (preview !== null && preview !== void 0 ? preview : state) })),\n        React.createElement(BottomToolbar, __assign({ open: focused, title: props.text, onDelete: remove, icon: props.IconComponent }, props),\n            React.createElement(\"div\", { style: { marginBottom: 24, maxHeight: '50vh', overflow: 'auto' } },\n                React.createElement(AutoForm, { model: preview || state, autosave: true, schema: bridge, onSubmit: onSubmit },\n                    React.createElement(\"div\", { style: {\n                            columnCount: controlsLayout.columnCount || 2,\n                            columnRule: '1px solid #E0E0E0',\n                            columnGap: 48,\n                        } },\n                        React.createElement(AutoFields, { element: Fragment })))))));\n}\nexport default Controls;\n//# sourceMappingURL=index.js.map"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}